---
layout: post
title: 2026-01-11(Sun)
date: 2026-01-11 10:00:00 +0900
categories: post
tags:
  - kotlin
  - til
---

Bug: Incorrect Japanese Era Year Conversion
For some reason, inputting "令和8" results in the year 2028. Upon investigation, I found that the root cause is the following code returning 2027 instead of 2026.

Kotlin

JapaneseDate.of(JapaneseEra.REIWA, 8, 12, 28).format(DateTimeFormatter.ofPattern("Y"))
I wasn't sure why this was happening, so I asked Gemini 3. It turns out that Y represents the "week-based-year" (the year the current week belongs to). Since December 28th falls within a week that includes days from the following year, it was being converted to 2027.

To fix this, Y should be changed to y.

...However, simply changing it to lowercase y would just output "8" (the era year). To get the Gregorian calendar year (AD), you must use withChronology to specify the conversion.

Kotlin

JapaneseDate.of(JapaneseEra.REIWA, 8, 12, 28).format(DateTimeFormatter.ofPattern("y").withChronology(IsoChronology.INSTANCE))
Key Technical Note
In the DateTimeFormatter patterns:

y: Year-of-era (standard year).

Y: Week-based-year (often causes bugs near the end of December).

